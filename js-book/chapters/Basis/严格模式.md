# 严格模式

## arguments对象的限制

- 不允许对arguments赋值

```javascript
(function(){
    "use strict";
    arguments++; // 语法错误
    var obj = { set p(arguments) { } }; // 语法错误
    try { } catch (arguments) { } // 语法错误
    function arguments() { } // 语法错误
    var f = new Function("arguments", "'use strict'; return 17;"); // 语法错误
})();
```

- arguments不再追踪参数的变化

```javascript
(function(){
    "use strict";
    function showValue(value){
        value="Foo";
        alert(value);
        alert(arguments[0]);
    }
    showValue('hi');//Foo hi(非严格模式下是Foo Foo)
})();
```

- 禁止使用arguments.callee

```javascript
(function(){
    "use strict";
    var f = function() { return arguments.callee; };
    f(); // 报错
})();
```

## 函数必须声明在顶层

```javascript
(function(){
    "use strict";
    if(true){
        function f(){}//语法错误
    }
    for(var i=0;i<5;i++){
        function f2(){}//语法错误
    }
})();
```

## 变量

- 全局变量必须显式声明

```javascript
(function(){
    "use strict";
    v=1;
    for(i=0;i<2;i++){}//v和i等为通过var声明的变量都会报错
})();
```

- 严格模式下无法删除变量。只有configurable设置为true的对象属性，才能被删除

```javascript
function haha(){
    "use strict";
    var a=10;
    delete a; //报错
    var o = Object.create(null, {'x': {
        value: 1,
        configurable: true
    }});
    delete o.x; // 删除成功
}
```

## 增强的安全措施

- 禁止this关键字指向全局对象

```javascript
(function(){
    function f(){return !this;} // 返回false，因为"this"指向全局对象，"!this"就是false
    function f(){
        "use strict";
        return !this; // 返回true，因为严格模式下，this的值为undefined，所以"!this"为true。
    }
})();
```

- 禁止在函数内部遍历调用栈

```javascript
(function(){
    function f1(){
        "use strict";
        f1.caller; // 报错
        f1.arguments; // 报错
    }
    f1();
})();
```

## 显式报错(对象属性的操作)

- 为只读属性赋值报错（这里没有验证错误）

```javascript
(function(){
    "use strict";
    var o = {};
    Object.defineProperty(o, "v", { value: 1, writable: false });
    o.v = 2; // 报错
})();
```

- 对一个使用getter方法读取的属性进行赋值，会报错

```javascript
(function(){
    "use strict";
    var o = {
        get v() { return 1; }
    };
    o.v = 2; // 报错
})();
```

- 删除一个不可删除的属性，会报错

```javascript
(function(){
    "use strict";
    delete Object.prototype; // 报错
})();
```

- 对禁止扩展的对象添加新属性，会报错

```javascript
(function(){
    "use strict";
    var o = {};
    Object.preventExtensions(o);
    o.v = 1; // 报错
})();
```

## 严格模式下使用JS的保留关键字作为变量名会导致语法错误

```javascript
function haha(){
    "use strict";
    function private() { } // 报错!
}
```

## 禁止八进制表示法

```javascript
(function(){
    "use strict";
    var n = 0100; // 语法错误
})();
```

## 重名错误

- 对象字面量同一个属性重复赋值（好像并不会报错，但是会有警示）

```javascript
(function(){
    "use strict";
    var person={
        name:"Tom",
        name:"cat"
    };
})();
```

- 严格模式下参数名不能重复

```javascript
(function(){
    "use strict";
    function sum(num, num) {}  //报错
})();
```

## 静态绑定

> 严格模式对动态绑定做了一些限制。某些情况下，只允许静态绑定。也就是说，属性和方法到底归属哪个对象，在编译阶段就确定。这样做有利于编译效率的提高，也使得代码更容易阅读，更少出现意外

```javascript
//禁止使用with语句
(function(){
    "use strict";
    var v = 1;
    with (o){ // 语法错误
        v = 2;
    }
})();
//创设eval作用域
(function(){
    "use strict";
    var x = 2;
    console.info(eval("var x = 5; x")); // 5
    console.info(x); // 2
})();
```
