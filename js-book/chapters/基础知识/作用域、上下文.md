# 上下文 vs 作用域

> 每个函数调用都有与之相关的作用域和上下文。从根本上说，作用域是基于函数，而上下文是基于对象
> 作用域是和每次函数调用时变量的访问有关，并且每次调用都是独立的。上下文总是关键字 this 的值，是调用当前可执行代码的对象的引用

---

## 作用域

> 变量和函数的可访问范围，即作用域控制着变量和函数的可见性和生命周期

## 相关概念

- 块级作用域
- 函数作用域

## 块级作用域（格式化上下文）

```js
(function() {
  // 块级作用域
})();
```

## var、let、const 区别

| \#    | 声明次数     | 作用域                             | 变量提升         | 是否是顶层对象属性 |
| ----- | ------------ | ---------------------------------- | ---------------- | ------------------ |
| var   | 可重复声明   | 作用于是函数作用域                 | 存在变量提升现象 | 可以是             |
| let   | 只能声明一次 | 块级别作用域（大括号括起来的内容） | 不存在变量提升   | 不是               |
| const | 只能声明一次 | 块级别作用域（大括号括起来的内容） | 不存在变量提升   | 不是               |

---

## this 指向

```js
// 被直接调用时，this 指全局对象 window。
func();

// 被作为构造函数调用时，this 指当前正在构建的对象。
new func();

// 被作为某个对象 A 的方法调用时，this 指方法所属的对象 A。
A.func();

// 使用函数的 apply 或 call 方法调用时，this 指第一个参数 B。
func.apply(B, [m, n, ...]);
func.call(B, m, n, ...);
```

## 箭头函数

- new 不可用。箭头函数不能使用 new 关键字来实例化对象，不然会报错。
- 对 this 的关联。函数内置 this 的值，取决于箭头函数在哪儿定义，而非箭头函数执行的上下文环境
- 没有 arguments 对象。更不能通过 arguments 对象访问传入参数。只能使用显式命名或其他 ES6 新特性来完成。
