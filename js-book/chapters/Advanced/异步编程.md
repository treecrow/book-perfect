# 异步编程

## Promises

--------------------------------------------------------------------------------

### Promise示例

```javascript
new promise((resolve, reject) => {
  a(getResultFromA, (aResult, err) => {
    if (!err) resolve(aResult) else reject(err)
  })
})
.then(data => {
  return new Promise((resolve, reject) => {
    b(getResultFromB, (bResult, err) => {
      if (!err) resolve(bResult) else reject(err)
    })
  }
})
.then(data => {
  return new Promise((resolve, reject) => {
    c(getResultFromC, (cResult, err) => {
      if (!err) resolve(cResult) else reject(err)
    })
  }
})
.then(data => {
  // do something
})
.catch(err => {
  throw err
})
```

### 同时提供回调函数和 Promise 接口

```javascript
function foo(cb) {  
  if (cb) {
    return cb();
  }
  return new Promise(function (resolve, reject) {

  });
}
```

## generator

--------------------------------------------------------------------------------

## async/await

--------------------------------------------------------------------------------

- [async 函数的含义和用法](http://www.ruanyifeng.com/blog/2015/05/async.html)

### 基础使用

```javascript
async function () {
  try {
    const aResult = await new Promise(/* getResultFromAPromise */)
    const bResult = await new Promise(/* getResultFromBProimse */)
    const cResult = await new Promise(/* getResultFromCPromise */)
    // do something
  } catch (err) {
    throw err
  }
}
```

### 并行执行

```javascript
//延时n毫秒
function timeout(ms) {
  return new Promise((resolve) => {
    setTimeout(resolve, ms);
  });
}
function consoleNum() {
  let nums = [1, 2, 3, 4, 5, 6, 7, 8, 9];
  nums.forEach(async function(num) {
    await timeout(2000);
    console.log(num);
  });
}
consoleNum();
```

### 串行执行

```javascript
//延时n毫秒
function timeout(ms) {
  return new Promise((resolve) => {
    setTimeout(resolve, ms);
  });
}
async function consoleNum() {
  let nums = [1, 2, 3, 4, 5, 6, 7, 8, 9];
  for (let num of nums) {
    await timeout(2000);
    console.log(num);
  }
}
consoleNum();
```
